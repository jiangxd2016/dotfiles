" ================================================================================================
" = Leader commands ===================================== Start
" ================================================================================================
" leaderkey
let mapleader=" "
set timeoutlen=500
" é˜²æ­¢æŒ‰leaderé”®ä¹±ç§»åŠ¨
nnoremap <SPACE> <nop>
" nohl å…³é—­æœç´¢é«˜äº®æ˜¾ç¤º
nnoremap <leader>nl :nohlsearch<CR>

" ReformatCode æ ¼å¼åŒ–ä»£ç CodeStyle
nnoremap <leader>fm :action ReformatCode<CR>

" Optimise Imports æ ¼å¼åŒ–imports
nnoremap <leader>fi :action OptimizeImports<CR>

" Run code
nnoremap <leader>rr :action Rerun<CR>
nnoremap <leader>rt :action RerunTests<CR>
" Refresh gradle
nnoremap <leader>rg :action ExternalSystem.RefreshAllProjects<CR>

" Insert into next bracket ç›´æ¥è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæ‹¬å·å†…å¼€å§‹æ’å…¥
nnoremap <leader>i f(a
vnoremap <leader>i f(a

" Add ; at the end of current line ç›´æ¥è·³è½¬åˆ°æœ¬è¡Œæœ«å°¾æ’å…¥;å·
nnoremap <leader>j A;<ESC>
vnoremap <leader>j A;<ESC>

" Gotos æ–‡æ¡£è·³è½¬
nnoremap ge :action GotoNextError<CR>
vnoremap ge :action GotoNextError<CR>
nnoremap gt :action GotoTest<CR>
nnoremap gm :action MethodUp<CR>

nnoremap <leader>ck :action CallHierarchy<CR>
nnoremap <leader>mk :action MethodHierarchy<CR>

" show bookmarks
" instead of use `s` to represent show, use `w` instead
" ğŸ”¥ğŸ”¥ ğŸ”¥ğŸ”¥ ğŸ”¥ğŸ”¥ Here I want to use nnoremap <leader>ss :action FileStructurePopup<CR>

nnoremap <leader>wb :action ShowBookmarks<ESC>
vnoremap <leader>wb :action ShowBookmarks<ESC>
nnoremap <leader>ws :action FileStructurePopup<CR>

" ========================================= Git =========================================
nnoremap <leader>gh :action Vcs.ShowTabbedFileHistory<CR>

nnoremap <leader>gc :action Compare.Selected<CR>

nnoremap <leader>gb :action Git.CompareWithBranch<CR>

" Fold and unFold
nnoremap <leader>zc :action CollapseAllRegions<CR>
nnoremap <leader>zo :action ExpandAllRegions<CR>

" ========================================= window & pane & split ========================================
" Unsplit editor æœ€å¤§åŒ–æ˜¾ç¤ºå½“å‰ç¼–è¾‘å™¨pane, å…³é—­å…¶ä»–split
nnoremap <leader>wo :action UnsplitAll<CR>
vnoremap <leader>wo :action UnsplitAll<CR>

nnoremap <leader>zz :action MaximizeEditorInSplit<CR>
vnoremap <leader>zz :action MaximizeEditorInSplit<CR>

" Close active pane
nnoremap <leader>wc <c-w>c
vnoremap <leader>wc <c-w>c

" ============================================ Floating Window ===========================================
nnoremap sd :action QuickJavaDoc<CR>
nnoremap se :action ShowErrorDescription<CR>
nnoremap st :action ExpressionTypeInfo<CR>

" ================================================ Refactor ================================================
" refactor -> rename
map <leader>rn :action RenameElement<CR>
" extract method/function
vnoremap <leader>em :action ExtractMethod<CR>
" extract constant
vnoremap <leader>ec :action IntroduceConstant<CR>
" extract field
vnoremap <leader>ef :action IntroduceField<CR>
" extract variable
vnoremap <leader>ev :action IntroduceVariable<CR>
" rollback line
nnoremap <leader>rb :action Vcs.RollbackChangedLines<CR>

" ================================================ Debug ================================================
nnoremap <leader>db :action ToggleLineBreakpoint<CR>
nnoremap <leader>di :action StepInto<CR>
nnoremap <leader>dn :action StepOver<CR>
nnoremap <leader>dr :action Resume<CR>

" Hide All windows
nnoremap <leader>cc :action HideAllWindows<CR>
vnoremap <leader>cc :action HideAllWindows<CR>



" åƒvscodeä¸€æ ·è¡Œç§»åŠ¨
vnoremap J :action MoveLineDown<CR>
vnoremap K :action MoveLineUp<CR>



" åé€€åŠŸèƒ½
nnoremap <leader>gb :action Back<CR>
nnoremap <leader>gb :action JumpToLastChange<CR>


" æ‰“ä¸Šæ–­ç‚¹æˆ–å–æ¶ˆæ–­ç‚¹
nnoremap <leader>dt :action ToggleLineBreakpoint<CR>
" å–æ¶ˆæ‰€æœ‰çš„æ–­ç‚¹
nnoremap <leader>dT :action Debugger.RemoveAllBreakpointsInFile<CR>
" debugä¸Šæ¬¡è¿è¡Œçš„ç±»
nnoremap <leader>dd :action Debug<CR>
" debugå½“å‰(now)ç±»
nnoremap <leader>dc :action DebugClass<CR>
" debugç¥å™¨
" StepInto (F7)
nnoremap <leader>di :action ForceStepInto<CR>
" ForceStepInto(CMD + SHIFT + F7)
nnoremap <leader>dI :action ForceStepInto
" StepOver (F8)
nnoremap <leader>do :action StepOver<CR>
" Resume (è·³åˆ°ä¸‹ä¸ªæ–­ç‚¹è¿è¡Œ)
nnoremap <leader>dr :action Resume<CR>
" StepOut (SHIFT+F8)
nnoremap <leader>du :action StepOut<CR>
" debugå¼ºåˆ¶è¿è¡Œåˆ°å…‰æ ‡å¤„
nnoremap <leader>dC :action ForceRunToCursor<CR>


"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""Create"""""""""""""""""""""""""""
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" æ–°å»ºç±»
nnoremap <leader>nc :action NewClass<CR>
" æ–°å»ºé¡¹ç›®
nnoremap <leader>np :action NewProject<CR>
" æ–°å»ºæ–‡ä»¶ (å˜»å˜»,å•¥éƒ½å¯ä»¥ç›´æ¥ç”¨å¿«æ·é”®å»ºç«‹,ä¸€ä¸ªå­—çˆ½)
nnoremap <leader>ne :action NewElement<CR>
" åˆ é™¤å½“å‰æ–‡ä»¶ (å¿«é€Ÿåˆ é™¤)
nnoremap <leader>nd :action SafeDelete<CR>
" å¤åˆ¶æ–‡ä»¶å…ƒç´ 
nnoremap <leader>ny :action CopyElement<CR>
" ä»£ç ç¯ç»•(å¿«é€Ÿæ·»åŠ if æˆ–è€…while)
nnoremap <leader>ns :action SurroundWith<CR>
vnoremap <leader>ns :action SurroundWith<CR>


"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""æ–‡ä»¶å’Œè·³è½¬"""""""""""""""""""""""""
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" é‡å‘½åæ–‡ä»¶
nnoremap <leader>rn :action RenameFile<CR>
"æœ€è¿‘æ”¹åŠ¨æ–‡ä»¶é—´ç›¸äº’è·³è½¬
nnoremap <leader>rf mm`m:action RecentChangedFiles<CR>
" æŸ¥æ‰¾æ–‡ä»¶
nnoremap <leader>ff mm`m:action GotoFile<CR>
" æœ€è¿‘æŸ¥çœ‹æ–‡ä»¶é—´ç›¸äº’è·³è½¬
nnoremap <leader>fr mm`m:action RecentFiles<CR>
" æŸ¥æ‰¾ç”¨æ³•
nnoremap <leader>fu :action FindUsages<CR>
"è·³è½¬åˆ°å£°æ˜
nnoremap gd mm`m:action GotoDeclaration<CR>
" æ‰“å¼€Generalèœå•
nnoremap go :action Generate<CR>
"è·³è½¬åˆ°å®ç°ç±»
nnoremap gi mm`m:action GotoImplementation<CR>
" æŸ¥æ‰¾ç±»
nnoremap gc mm`m:action GotoClass<CR>
" è·³è½¬SuperMethod
nnoremap gs mm`m:action GotoSuperMethod<CR>
" ç›®å‰è¿˜ä¸ç†Ÿæ‚‰ (åé¢ææ‡‚å›æ¥è¡¥å……)
nnoremap gf mm`m:action FileStructurePopup<CR>
" æœç´¢ action
nnoremap <leader>ga :action GotoAction<CR>
"ç›¸å½“äºé¼ æ ‡å³é”®
nnoremap <leader>sp :action ShowPopupMenu<CR>

" ================================================================================================
" = Extensions ===================================== Start
" ================================================================================================
set surround
set argtextobj
set ReplaceWithRegister
set NERDTree

nnoremap ma mA
nnoremap 'a 'A
nnoremap ms mS
nnoremap 's 'S
nnoremap md mD
nnoremap 'd 'D
nnoremap mf mF
nnoremap 'f 'F

nnoremap ga '.

nnoremap <leader>e :action ActivateProjectToolWindow<CR>

" argtextobj
let g:argtextobj_pairs="(:),{:},<:>"

" ================================================================================================
" = Other settings ===================================== Start
" ================================================================================================
set clipboard+=unnamed
set ignorecase
set scrolloff=30
set history=200

set number
set relativenumber

set incsearch
set hlsearch
set easymotion
set keep-english-in-normal
set which-key
set timeoutlen = 5000


let g:WhichKeyDesc_windows_maximize = "<leader>wm maximize"
